<?xml version="1.0" encoding="UTF-8"?><Session>
<Field name="Session Name">PRD_GET_CONCATENATED_DIMENSION_LEVELS</Field>
<Field name="Context Code">GLOBAL</Field>
<SessStep>
<Field name="Step Name">PRD_GET_CONCATENATED_DIMENSION_LEVELS</Field>
<Field name="Step No">1</Field>
<Field name="Step Type">T</Field>
<Field name="Ok Exit">0</Field>
<Field name="Ko Exit">0</Field>
<StepLog>
<SessTaskLog>
<Field name="Task Type ">S</Field>
<Field name="Task Name 1">Procedure</Field>
<Field name="Task Name 2">PRD_GET_CONCATENATED_DIMENSION_LEVELS</Field>
<Field name="Task Name 3">Update Concatenated Segments</Field>
<Field name="Exe Channel">J</Field>
<Field name="Source Context Code">GLOBAL</Field>
<Field name="Target Context Code">GLOBAL</Field>
<Field name="Target Logical Schema Name">LGL_STG</Field>
<Field name="Target Technology Internal Name">ORACLE</Field>
<Default>
<Field name="Text">UPDATE STG_#DW.Var_Dimension_Table_99
SET CONCAT_HIER=
(
 SELECT distinct '|'||max(TOPMEM||CONC.CONCATENATED)||'|' FROM 
(
	SELECT SYS_CONNECT_BY_PATH(CHILD,'|') CONCATENATED, LEVEL, GENERIC_ID, CONNECT_BY_ROOT PARENT AS TOPMEM, CONNECT_BY_ISLEAF AS ISLEAF
	FROM STG_T_PARENT_CHILD_D_1
	WHERE DIM_NAME='#DW.Var_Dim_Name' 
	START WITH PARENT IN (#DW.Var_List_Dimension_Top_Members )
	CONNECT BY PRIOR CHILD=PARENT
  
) CONC
	WHERE 
	
	 SUBSTR(CONC.CONCATENATED,INSTR(CONC.CONCATENATED,'|',-1,1)+1)=STG_#DW.Var_Dimension_Table_99.#DW.Var_Primary_Column_Name
	AND CONC.GENERIC_ID=STG_#DW.Var_Dimension_Table_99.GENERIC_ID
	AND CONC.ISLEAF=1
	)
where exists
(SELECT distinct NULL
from (
	SELECT SYS_CONNECT_BY_PATH(CHILD,'|') CONCATENATED, LEVEL, GENERIC_ID, CONNECT_BY_ROOT PARENT AS TOPMEM, CONNECT_BY_ISLEAF AS ISLEAF
	FROM STG_T_PARENT_CHILD_D_1
	WHERE DIM_NAME='#DW.Var_Dim_Name' 
	START WITH PARENT IN (#DW.Var_List_Dimension_Top_Members )
	CONNECT BY PRIOR CHILD=PARENT
) CONC, STG_#DW.Var_Dimension_Table_99
	WHERE 
	
	 SUBSTR(CONC.CONCATENATED,INSTR(CONC.CONCATENATED,'|',-1,1)+1)=STG_#DW.Var_Dimension_Table_99.#DW.Var_Primary_Column_Name
	AND CONC.GENERIC_ID=STG_#DW.Var_Dimension_Table_99.GENERIC_ID
  AND CONC.ISLEAF=1)</Field>
</Default>
</SessTaskLog>
</StepLog>
</SessStep>
</Session>
