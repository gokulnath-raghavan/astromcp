<?xml version="1.0" encoding="UTF-8"?><Session>
<Field name="Session Name">MAP_STAGE_TOP_MEMBERS_STG_T_PARENT_CHILD_D_2_Physical_SESS</Field>
<Field name="Context Code">GLOBAL</Field>
<SessStep>
<Field name="Step Name">Physical_STEP</Field>
<Field name="Step No">10</Field>
<Field name="Step Type">MAPPING</Field>
<Field name="Ok Exit">false</Field>
<Field name="Ko Exit">false</Field>
<StepLog>
<SessTaskLog>
<Field name="Task Type ">EX_UNIT_BEGIN</Field>
<Field name="Task Name 1">SERIAL</Field>
<Field name="Task Name 2">MAP_MAIN</Field>
</SessTaskLog>
<SessTaskLog>
<Field name="Task Type ">EX_UNIT_BEGIN</Field>
<Field name="Task Name 1">SERIAL</Field>
<Field name="Task Name 2">EU</Field>
<Field name="Task Name 3">LGL_DW_STG_UNIT</Field>
</SessTaskLog>
<SessTaskLog>
<Field name="Task Type ">EX_UNIT_MAIN</Field>
<Field name="Task Name 1">Insert new rows</Field>
<Field name="Task Name 2">IKM SQL Control Append</Field>
<Field name="Source Logical Schema Name">LGL_STG</Field>
<Field name="Source Connection Name">STG</Field>
<Field name="Source Isolation Level">DEFAULT</Field>
<Field name="Target Logical Schema Name">LGL_STG</Field>
<Field name="Target Connection Name">STG</Field>
<Field name="Target Commit Indicator">NO_COMMIT</Field>
<Target>
<Field name="Text"> 
insert into	DEV_STG_USP.STG_T_PARENT_CHILD_D_1 
( 
    SOURCE,
	GENERIC_ID,
	DIM_NAME,
	PARENT,
	CHILD,
	BASE_LEVEL_FLAG 
) 
select 	
    DISTINCT_1.SOURCE AS SOURCE,
	DISTINCT_1.GENERIC_ID AS GENERIC_ID,
	DISTINCT_1.DIM_NAME AS DIM_NAME,
	DISTINCT_1.DIM_NAME AS PARENT,
	DISTINCT_1.PARENT AS CHILD,
	'N' AS BASE_LEVEL_FLAG
from	(
SELECT 
  DISTINCT 
  STG_T_PARENT_CHILD_D_1.SOURCE AS SOURCE ,
  STG_T_PARENT_CHILD_D_1.GENERIC_ID AS GENERIC_ID ,
  STG_T_PARENT_CHILD_D_1.DIM_NAME AS DIM_NAME ,
  STG_T_PARENT_CHILD_D_1.PARENT AS PARENT   
FROM 
  DEV_STG_USP.STG_T_PARENT_CHILD_D_1 STG_T_PARENT_CHILD_D_1  LEFT OUTER JOIN  DEV_STG_USP.STG_T_PARENT_CHILD_D_1 STG_T_PARENT_CHILD_D_12  
    ON  STG_T_PARENT_CHILD_D_1.PARENT=STG_T_PARENT_CHILD_D_12.CHILD
AND STG_T_PARENT_CHILD_D_1.DIM_NAME=STG_T_PARENT_CHILD_D_12.DIM_NAME
AND STG_T_PARENT_CHILD_D_1.GENERIC_ID=STG_T_PARENT_CHILD_D_12.GENERIC_ID
AND STG_T_PARENT_CHILD_D_1.SOURCE=STG_T_PARENT_CHILD_D_12.SOURCE
WHERE
  (STG_T_PARENT_CHILD_D_12.PARENT is null
) 
  ) DISTINCT_1
where		(1=1)	
  </Field>
</Target>
</SessTaskLog>
<SessTaskLog>
<Field name="Task Type ">EX_UNIT_MAIN</Field>
<Field name="Task Name 1">Commit transaction</Field>
<Field name="Task Name 2">IKM SQL Control Append</Field>
<Field name="Source Logical Schema Name">LGL_STG</Field>
<Field name="Source Connection Name">STG</Field>
<Field name="Source Isolation Level">DEFAULT</Field>
<Field name="Target Logical Schema Name">LGL_STG</Field>
<Field name="Target Connection Name">STG</Field>
<Field name="Target Commit Indicator">COMMIT</Field>
<Target>
<Field name="Text">/* commit */ </Field>
</Target>
</SessTaskLog>
</StepLog>
</SessStep>
</Session>
