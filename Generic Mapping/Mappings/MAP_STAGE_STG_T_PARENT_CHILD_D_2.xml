<?xml version="1.0" encoding="UTF-8"?><Session>
<Field name="Session Name">MAP_STAGE_STG_T_PARENT_CHILD_D_2_Physical_SESS</Field>
<Field name="Context Code">GLOBAL</Field>
<SessStep>
<Field name="Step Name">Physical_STEP</Field>
<Field name="Step No">10</Field>
<Field name="Step Type">MAPPING</Field>
<Field name="Ok Exit">false</Field>
<Field name="Ko Exit">false</Field>
<StepLog>
<SessTaskLog>
<Field name="Task Type ">MAP_BEGIN</Field>
<Field name="Task Name 1">SERIAL</Field>
<Field name="Task Name 2">MAP_BEGIN</Field>
</SessTaskLog>
<SessTaskLog>
<Field name="Task Type ">MAP_BEGIN</Field>
<Field name="Task Name 1">SERIAL</Field>
<Field name="Task Name 2">EU</Field>
<Field name="Task Name 3">LGL_DW_STG_UNIT</Field>
</SessTaskLog>
<SessTaskLog>
<Field name="Task Type ">MAP_BEGIN</Field>
<Field name="Task Name 1">Truncate target table</Field>
<Field name="Task Name 2">IKM Oracle Insert</Field>
<Field name="Exe Channel">JDBC</Field>
<Field name="Source Logical Schema Name">LGL_STG</Field>
<Field name="Source Connection Name">STG</Field>
<Field name="Source Isolation Level">DEFAULT</Field>
<Field name="Target Logical Schema Name">LGL_STG</Field>
<Field name="Target Connection Name">STG</Field>
<Field name="Target Isolation Level">DEFAULT</Field>
<Field name="Target Technology Internal Name">GENERIC_SQL</Field>
<Target>
<Field name="Text">
truncate table DEV_STG_USP.STG_T_PARENT_CHILD_D_2
           </Field>
</Target>
</SessTaskLog>
<SessTaskLog>
<Field name="Task Type ">EX_UNIT_BEGIN</Field>
<Field name="Task Name 1">SERIAL</Field>
<Field name="Task Name 2">MAP_MAIN</Field>
</SessTaskLog>
<SessTaskLog>
<Field name="Task Type ">EX_UNIT_BEGIN</Field>
<Field name="Task Name 1">SERIAL</Field>
<Field name="Task Name 2">EU</Field>
<Field name="Task Name 3">LGL_DW_STG_UNIT</Field>
</SessTaskLog>
<SessTaskLog>
<Field name="Task Type ">EX_UNIT_MAIN</Field>
<Field name="Task Name 1">Insert new rows</Field>
<Field name="Task Name 2">IKM Oracle Insert</Field>
<Field name="Task Name 3">Load STG_T_PARENT_CHILD_D_2</Field>
<Field name="Exe Channel">JDBC</Field>
<Field name="Source Logical Schema Name">LGL_STG</Field>
<Field name="Source Connection Name">STG</Field>
<Field name="Source Isolation Level">DEFAULT</Field>
<Field name="Target Logical Schema Name">LGL_STG</Field>
<Field name="Target Connection Name">STG</Field>
<Field name="Target Isolation Level">DEFAULT</Field>
<Field name="Target Technology Internal Name">ORACLE</Field>
<Target>
<Field name="Text">
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO DEV_STG_USP.STG_T_PARENT_CHILD_D_2
  (
    SOURCE ,
    GENERIC_ID ,
    DIM_NAME ,
    MEMBER ,
    MEMBER_DESC 
  ) 
SELECT 
  '#DW.Var_Source' ,
  DISTINCT_.FLEX_VALUE_SET_ID ,
  UPPER(REPLACE(REPLACE(TRIM(DISTINCT_.SEGMENT_NAME), ' ', '_'),'-','_')) ,
  DISTINCT_.FLEX_VALUE ,
  DISTINCT_.MEMBER_DESC  
FROM 
  (
SELECT 
  DISTINCT 
  STG_FND_ID_FLEX_SEGMENTS.FLEX_VALUE_SET_ID AS FLEX_VALUE_SET_ID ,
  STG_FND_ID_FLEX_SEGMENTS.SEGMENT_NAME AS SEGMENT_NAME ,
  STG_FND_FLEX_VALUES_VL.FLEX_VALUE AS FLEX_VALUE ,
  '#DW.Var_Source' AS SOURCE ,
  STG_FND_ID_FLEX_SEGMENTS.FLEX_VALUE_SET_ID AS GENERIC_ID ,
  STG_FND_ID_FLEX_SEGMENTS.SEGMENT_NAME AS DIM_NAME ,
  STG_FND_FLEX_VALUES_VL.FLEX_VALUE AS MEMBER ,
  STG_FND_FLEX_VALUES_VL.DESCRIPTION AS MEMBER_DESC   
FROM 
  DEV_STG_USP.STG_FND_FLEX_VALUES_VL STG_FND_FLEX_VALUES_VL  INNER JOIN  DEV_STG_USP.STG_FND_ID_FLEX_SEGMENTS STG_FND_ID_FLEX_SEGMENTS  
    ON  STG_FND_ID_FLEX_SEGMENTS.FLEX_VALUE_SET_ID = STG_FND_FLEX_VALUES_VL.FLEX_VALUE_SET_ID
--AND STG_OU_COA.COA_ID=STG_FND_ID_FLEX_SEGMENTS.ID_FLEX_NUM
AND STG_FND_ID_FLEX_SEGMENTS.ID_FLEX_NUM in (#DW.Var_EBS_COA)
WHERE
  (STG_FND_ID_FLEX_SEGMENTS.APPLICATION_ID =101 
AND STG_FND_ID_FLEX_SEGMENTS.ID_FLEX_CODE ='GL#'
) 
  ) DISTINCT_  
       </Field>
</Target>
</SessTaskLog>
</StepLog>
</SessStep>
</Session>
