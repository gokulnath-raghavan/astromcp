<?xml version="1.0" encoding="UTF-8"?><Session>
<Field name="Session Name">MAP_STAGE_STG_T_PARENT_CHILD_D_1_Physical_SESS</Field>
<Field name="Context Code">GLOBAL</Field>
<SessStep>
<Field name="Step Name">Physical_STEP</Field>
<Field name="Step No">10</Field>
<Field name="Step Type">MAPPING</Field>
<Field name="Ok Exit">false</Field>
<Field name="Ko Exit">false</Field>
<StepLog>
<SessTaskLog>
<Field name="Task Type ">MAP_BEGIN</Field>
<Field name="Task Name 1">SERIAL</Field>
<Field name="Task Name 2">MAP_BEGIN</Field>
</SessTaskLog>
<SessTaskLog>
<Field name="Task Type ">MAP_BEGIN</Field>
<Field name="Task Name 1">SERIAL</Field>
<Field name="Task Name 2">EU</Field>
<Field name="Task Name 3">LGL_DW_STG_UNIT</Field>
</SessTaskLog>
<SessTaskLog>
<Field name="Task Type ">MAP_BEGIN</Field>
<Field name="Task Name 1">Truncate target table</Field>
<Field name="Task Name 2">IKM Oracle Insert</Field>
<Field name="Exe Channel">JDBC</Field>
<Field name="Source Logical Schema Name">LGL_STG</Field>
<Field name="Source Connection Name">STG</Field>
<Field name="Source Isolation Level">DEFAULT</Field>
<Field name="Target Logical Schema Name">LGL_STG</Field>
<Field name="Target Connection Name">STG</Field>
<Field name="Target Isolation Level">DEFAULT</Field>
<Field name="Target Technology Internal Name">GENERIC_SQL</Field>
<Target>
<Field name="Text">
truncate table DEV_STG_USP.STG_T_PARENT_CHILD_D_1
           </Field>
</Target>
</SessTaskLog>
<SessTaskLog>
<Field name="Task Type ">EX_UNIT_BEGIN</Field>
<Field name="Task Name 1">SERIAL</Field>
<Field name="Task Name 2">MAP_MAIN</Field>
</SessTaskLog>
<SessTaskLog>
<Field name="Task Type ">EX_UNIT_BEGIN</Field>
<Field name="Task Name 1">SERIAL</Field>
<Field name="Task Name 2">EU</Field>
<Field name="Task Name 3">LGL_DW_STG_UNIT</Field>
</SessTaskLog>
<SessTaskLog>
<Field name="Task Type ">EX_UNIT_MAIN</Field>
<Field name="Task Name 1">Insert new rows</Field>
<Field name="Task Name 2">IKM Oracle Insert</Field>
<Field name="Task Name 3">Load STG_T_PARENT_CHILD_D_1</Field>
<Field name="Exe Channel">JDBC</Field>
<Field name="Source Logical Schema Name">LGL_STG</Field>
<Field name="Source Connection Name">STG</Field>
<Field name="Source Isolation Level">DEFAULT</Field>
<Field name="Target Logical Schema Name">LGL_STG</Field>
<Field name="Target Connection Name">STG</Field>
<Field name="Target Isolation Level">DEFAULT</Field>
<Field name="Target Technology Internal Name">ORACLE</Field>
<Target>
<Field name="Text">
INSERT 
  /*+  APPEND PARALLEL  */ 
  INTO DEV_STG_USP.STG_T_PARENT_CHILD_D_1
  (
    SOURCE ,
    GENERIC_ID ,
    DIM_NAME ,
    PARENT ,
    CHILD ,
    BASE_LEVEL_FLAG 
  ) 
SELECT 
  '#DW.Var_Source' ,
  DISTINCT_1.FLEX_VALUE_SET_ID ,
  UPPER(REPLACE(REPLACE(TRIM(DISTINCT_1.SEGMENT_NAME), ' ', '_'),'-','_')) ,
  DISTINCT_1.PARENT_FLEX_VALUE ,
  DISTINCT_1.FLEX_VALUE ,
  DISTINCT_1.SUMMARY_FLAG  
FROM 
  (
SELECT 
  DISTINCT 
  DISTINCT_.FLEX_VALUE_SET_ID AS FLEX_VALUE_SET_ID ,
  DISTINCT_.PARENT_FLEX_VALUE AS PARENT_FLEX_VALUE ,
  DISTINCT_.FLEX_VALUE AS FLEX_VALUE ,
  DISTINCT_.SUMMARY_FLAG AS SUMMARY_FLAG ,
  DISTINCT_.SEGMENT_NAME AS SEGMENT_NAME   
FROM 
  (
SELECT 
  DISTINCT 
  STG_FND_FLEX_VALUE_NORM_HIER.FLEX_VALUE_SET_ID AS FLEX_VALUE_SET_ID ,
  STG_FND_FLEX_VALUE_NORM_HIER.PARENT_FLEX_VALUE AS PARENT_FLEX_VALUE ,
  STG_FND_FLEX_VALUES_VL.FLEX_VALUE AS FLEX_VALUE ,
  STG_FND_FLEX_VALUES_VL.SUMMARY_FLAG AS SUMMARY_FLAG ,
  STG_FND_ID_FLEX_SEGMENTS.SEGMENT_NAME AS SEGMENT_NAME   
FROM 
  (DEV_STG_USP.STG_FND_FLEX_VALUE_NORM_HIER STG_FND_FLEX_VALUE_NORM_HIER  INNER JOIN  DEV_STG_USP.STG_FND_FLEX_VALUES_VL STG_FND_FLEX_VALUES_VL  
    ON  1=1
     )  INNER JOIN  DEV_STG_USP.STG_FND_ID_FLEX_SEGMENTS STG_FND_ID_FLEX_SEGMENTS  
    ON  STG_FND_FLEX_VALUES_VL.FLEX_VALUE BETWEEN  STG_FND_FLEX_VALUE_NORM_HIER.CHILD_FLEX_VALUE_LOW AND  STG_FND_FLEX_VALUE_NORM_HIER.CHILD_FLEX_VALUE_HIGH AND STG_FND_FLEX_VALUES_VL.FLEX_VALUE_SET_ID  = STG_FND_FLEX_VALUE_NORM_HIER.FLEX_VALUE_SET_ID 
AND STG_FND_ID_FLEX_SEGMENTS.FLEX_VALUE_SET_ID = STG_FND_FLEX_VALUES_VL.FLEX_VALUE_SET_ID
AND STG_FND_ID_FLEX_SEGMENTS.ID_FLEX_NUM in (#DW.Var_EBS_COA)
WHERE
  (STG_FND_ID_FLEX_SEGMENTS.APPLICATION_ID =101 
AND STG_FND_ID_FLEX_SEGMENTS.ID_FLEX_CODE ='GL#' 
AND (STG_FND_FLEX_VALUE_NORM_HIER.PARENT_FLEX_VALUE&lt;&gt;STG_FND_FLEX_VALUE_NORM_HIER.CHILD_FLEX_VALUE_LOW and STG_FND_FLEX_VALUE_NORM_HIER.PARENT_FLEX_VALUE&lt;&gt;STG_FND_FLEX_VALUE_NORM_HIER.CHILD_FLEX_VALUE_HIGH)
) 
  ) DISTINCT_  
WHERE
  (DISTINCT_.PARENT_FLEX_VALUE&lt;&gt;DISTINCT_.FLEX_VALUE
) 
  ) DISTINCT_1  
       </Field>
</Target>
</SessTaskLog>
</StepLog>
</SessStep>
</Session>
